class <%= class_name %> < ApplicationRecord
  has_secure_password :password
  has_secure_token :session_token

  validates :email, presence: true, uniqueness: true
  validates :email, format: { with: /\A[^@\s]+@[^@\s]+\z/ }
  validates_length_of :password, minimum: 8, allow_blank: true

  before_validation { self.email = email.downcase.strip }

  def as_json(options)
    super(options.merge(except: [:password_digest, :session_token]))
  end  
end
